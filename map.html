<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Marine-X | Species Map</title>
  <link rel="stylesheet" href="style.css">
 <link rel="icon" type="image/png" href="sih.png" />
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDSvUiXNYcM_PLFus8zreB8LJ3HYG9ksqM"></script>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="logo">üêã Marine-X</div>
    <ul>
      <li><a href="index.html">Home</a></li>
     
      <li><a href="visualization.html">Visualization</a></li>
      <li><a href="map.html" class="active">Species Map</a></li>
      <li><a href="login.html">Login</a></li>
    </ul>
  </nav>

  <!-- Page Header -->
  <section class="page-header">
    <h1>Marine Species Hotspot Map</h1>
    <p>Explore key biodiversity hotspots in India's Exclusive Economic Zone (EEZ).  
    Click on a marker to learn more about species distribution, abundance, and conservation concerns.</p>
  </section>

  <!-- Map Section -->
  <section class="map-container">
    <div id="map"></div>
  </section>


  <!-- Table Section -->
<section id="table-section" class="mb-4">
  <h3>Species Records (Sample)</h3>
  <div class="table-responsive">
    <table class="table table-striped" id="speciesTable">
      <thead>
        <tr>
          <th>Individual Count</th>
          <th>Sex</th>
          <th>Habitat</th>
          <th>Water Body</th>
          <th>Country</th>
          <th>Locality</th>
          <th>Min Depth</th>
          <th>Latitude</th>
          <th>Longitude</th>
          <th>Scientific Name</th>
          <th>Common Name</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</section>



  <!-- Footer -->
  <footer>
    <p>&copy; 2025 Marine-X | Powered by Google Maps</p>
  </footer>

  <!-- Google Map & CSV Script -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>
let records = [];

function loadCSV() {
  Papa.parse('data/dummy_marine_data.csv', {
    download: true,
    header: true,
    dynamicTyping: true,
    complete: function(results) {
      // Trim headers and remove empty rows
      records = results.data
        .map(r => {
          const cleaned = {};
          for (let k in r) cleaned[k.trim()] = r[k];
          return cleaned;
        })
        .filter(r => r && r["scientific_name"]); // Only keep rows with valid scientific_name

      populateTable();
    },
    error: function(err) {
      console.error(err);
      alert("CSV load error: " + err);
    }
  });
}

function populateTable() {
  const tbody = document.querySelector("#speciesTable tbody");
  tbody.innerHTML = "";

  records.forEach(r => {
    const row = `
      <tr>
        <td>${r["individual_count"] || ""}</td>
        <td>${r["sex"] || ""}</td>
        <td>${r["habitat"] || ""}</td>
        <td>${r["water_body"] || ""}</td>
        <td>${r["country"] || ""}</td>
        <td>${r["locality"] || ""}</td>
        <td>${r["min_depth"] || ""}</td>
        <td>${r["latitude"] || ""}</td>
        <td>${r["longitude"] || ""}</td>
        <td>${r["scientific_name"] || ""}</td>
        <td>${r["common_name"] || ""}</td>
      </tr>`;
    tbody.insertAdjacentHTML("beforeend", row);
  });
}

function initMap() {
  const centerCoords = { lat: 12.5, lng: 75.0 };
  const map = new google.maps.Map(document.getElementById("map"), {
    zoom: 5,
    center: centerCoords
  });

  // Sample species markers
  const speciesData = [
    {
      coords: { lat: 15.3, lng: 73.8 },
      name: "Tuna",
      abundance: "High",
      threat: "Overfishing",
      info: "Tuna stocks are critical for export fisheries, but unsustainable practices are a major threat."
    },
    {
      coords: { lat: 9.9, lng: 76.3 },
      name: "Mackerel",
      abundance: "Moderate",
      threat: "Habitat Degradation",
      info: "Mackerel are an important food fish in India. Climate change and pollution affect their habitats."
    },
    {
      coords: { lat: 18.6, lng: 72.9 },
      name: "Sardine",
      abundance: "Fluctuating",
      threat: "Climate Variability",
      info: "Sardine populations are highly sensitive to ocean temperature shifts and monsoon cycles."
    }
  ];

  speciesData.forEach(species => {
    const marker = new google.maps.Marker({
      position: species.coords,
      map: map,
      title: species.name
    });

    const infoWindow = new google.maps.InfoWindow({
      content: `
        <div style="max-width:250px;">
          <h3>${species.name}</h3>
          <p><b>Abundance:</b> ${species.abundance}</p>
          <p><b>Main Threat:</b> ${species.threat}</p>
          <p>${species.info}</p>
        </div>
      `
    });

    marker.addListener("click", () => {
      infoWindow.open(map, marker);
    });
  });
}

// Initialize map and load CSV on page load
window.onload = function() {
  initMap();
  loadCSV();
};
</script>


</body>
</html>
